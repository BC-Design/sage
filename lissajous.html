<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<!-- Local files containing the website icon and stylesheet. -->
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<link rel="stylesheet" type="text/css" href="theme.css">

<!-- Imports needed to use the Sage cell server. -->
<script type="text/javascript" src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script type="text/javascript" src="https://sagecell.sagemath.org/embedded_sagecell.js"></script>
<script type="text/javascript" src="sagecell.js"></script>
<script type="text/javascript" src="sage-text.js"></script>
<script type="text/javascript" src="ganalytics.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

<!-- Additional CSS customizations. --> 
<style type="text/css"></style>

<!-- Page title. --> 
<title>Sage Math - Lissajous Figures</title>
</head>


<body>
<h1>Sage Math Tutorial - Lissajous Figures</h1>
<script type="text/javascript">sageHome()</script>

<p>This page contains interactive Sage widgets - edit and re-evaluate them!</p>
<p>Lissajous figures can be used to approximate power dissipation in a plasma discharge.</p>

<!-- Create the Sage cell. -->
<div class="sagecell-linked" id="sagecell1"><script type="application/sage">
windowSize = 1
Vapp = [(0,0),(1,1),(2,-1),(1,-2),(0,0)]
Vcap = [(0,0),(1,1),(2,2),(3,1),(4,0)]
</script></div>

<!-- Create the Sage cell. -->
<div class="sagecell-linked" id="sagecell2"><script type="application/sage">
### Python style guide: http://legacy.python.org/dev/peps/pep-0008/
reset()
from numpy import convolve, ones

def moving_average(interval, window_size):
    """Finds the moving average of a dataset over a window size."""
    # algorithm via http://stackoverflow.com/questions/11352047/finding-moving-average-from-data-points-in-python
    window= ones(int(window_size))/float(window_size)
    return convolve(interval, window, 'same')

def find_area(array):
    """Find the array of a polygon defined as a set of Cartesian points in an array."""
    # algorithm via http://www.arachnoid.com/area_irregular_polygon/index.html
    a = 0
    ox,oy = array[0]
    for x,y in array[1:]:
        a += (x*oy-y*ox)
        ox,oy = x,y
    return a/2

def create_lissajous(Vapp,Vcap,window=1):
    """Generates a Lissajous figure from the applied and capacitor voltage oscilloscope traces."""
    x=[Vapp[i][1] for i in range(0,len(Vapp))]
    y=[Vcap[i][1] for i in range(0,len(Vcap))]
    if window!= 1:
        x = moving_average(x,window)
        y = moving_average(y,window)
    Liss = []
    for i in range(0,len(Vapp)):
        Liss.append((x[i],y[i]))
    return Liss

Liss = create_lissajous(Vapp=Vapp,Vcap=Vcap,window=windowSize)
a = list_plot([])
a = list_plot(Liss)
area = find_area(Liss)
show('The area of the Lissajous figure is: ' + str(area))
show(a)
</script></div>

<script type="text/javascript">sageFooter()</script>

</body>
</html>


